###################### Auditbeat Configuration Example #########################

# This is an example configuration file highlighting only the most common
# options. The auditbeat.reference.yml file from the same directory contains all
# the supported options with more comments. You can use it as a reference.
#
# You can find the full configuration reference here:
# https://www.elastic.co/guide/en/beats/auditbeat/index.html

#==========================  Modules configuration =============================
auditbeat.modules:

- module: auditd
  # Load audit rules from separate files. Same format as audit.rules(7).
  audit_rule_files: [ '${path.config}/audit.rules.d/*.conf' ]
  audit_rules: |
  ## Define audit rules here.
  ## Create file watches (-w) or syscall audits (-a or -A). Uncomment these
  ## examples or add your own rules.

  ## If you are on a 64 bit platform, everything should be running
  ## in 64 bit mode. This rule will detect any use of the 32 bit syscalls
  ## because this might be a sign of someone exploiting a hole in the 32
  ## bit API.
  #-a always,exit -F arch=b32 -S all -F key=32bit-abi

  ## Executions.
  #-a always,exit -F arch=b64 -S execve,execveat -k exec

  ## External access (warning: these can be expensive to audit).
  #-a always,exit -F arch=b64 -S accept,bind,connect -F key=external-access

  ## Identity changes.
  #-w /etc/group -p wa -k identity
  #-w /etc/passwd -p wa -k identity
  #-w /etc/gshadow -p wa -k identity

  ## Unauthorized access attempts.
  #-a always,exit -F arch=b64 -S open,creat,truncate,ftruncate,openat,open_by_handle_at -F exit=-EACCES -k access
  #-a always,exit -F arch=b64 -S open,creat,truncate,ftruncate,openat,open_by_handle_at -F exit=-EPERM -k access

setup.template.enabled: false

#================================ General =====================================

# The name of the shipper that publishes the network data. It can be used to group
# all the transactions sent by a single shipper in the web interface.
#name:

# The tags of the shipper are included in their own field with each
# transaction published.
#tags: ["service-X", "web-tier"]

# Optional fields that you can specify to add additional information to the
# output.
#fields:
#  env: staging


#============================== Dashboards =====================================
# These settings control loading the sample dashboards to the Kibana index. Loading
# the dashboards is disabled by default and can be enabled either by setting the
# options here, or by using the `-setup` CLI flag or the `setup` command.
#setup.dashboards.enabled: false

# The URL from where to download the dashboards archive. By default this URL
# has a value which is computed based on the Beat name and version. For released
# versions, this URL points to the dashboard archive on the artifacts.elastic.co
# website.
#setup.dashboards.url:

#============================== Kibana =====================================


#================================ Outputs =====================================

# Configure what output to use when sending the data collected by the beat.

output.file:
  path: "/var/log/auditbeat"
  filename: auditbeat
  rotate_every_kb: 8388608
  number_of_files: 10
  permissions: 0600
  codec.json:
  pretty: false

# output.kafka:
#   # initial brokers for reading cluster metadata
#   hosts: ["localhost:9092"]

#   # message topic selection + partitioning
#   topic: 'test'
#   partition.round_robin:
#     reachable_only: false

#   required_acks: 1
#   # compression: gzip
#   max_message_bytes: 1000000

#================================ Processors =====================================

# Configure processors to enhance or manipulate events generated by the beat.

# processors:
#   - add_host_metadata: ~
#   - add_cloud_metadata: ~
processors:
    - drop_fields:
        fields: ["beat", "host", "event", "process.title", "auditd.summary"]

#================================ Logging =====================================

# Sets log level. The default log level is info.
# Available log levels are: error, warning, info, debug
#logging.level: debug

# At debug level, you can selectively enable logging only for some components.
# To enable all selectors use ["*"]. Examples of other selectors are "beat",
# "publish", "service".
#logging.selectors: ["*"]

#============================== Xpack Monitoring ===============================
# auditbeat can export internal metrics to a central Elasticsearch monitoring
# cluster.  This requires xpack monitoring to be enabled in Elasticsearch.  The
# reporting is disabled by default.

# Set to true to enable the monitoring reporter.
#xpack.monitoring.enabled: false

# Uncomment to send the metrics to Elasticsearch. Most settings from the
# Elasticsearch output are accepted here as well. Any setting that is not set is
# automatically inherited from the Elasticsearch output configuration, so if you
# have the Elasticsearch output configured, you can simply uncomment the
# following line.
#xpack.monitoring.elasticsearch:
